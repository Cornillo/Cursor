<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <link rel="icon" href="https://mediaaccesscompany.com/wp-content/uploads/2022/12/logo_banner_home.png" type="image/png">
  <title>Ajuda - Conversor Excel para STL</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2c3e50;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    h2 {
      color: #3498db;
      margin-top: 30px;
      padding-bottom: 5px;
      border-bottom: 1px solid #eee;
    }
    .section {
      margin-bottom: 30px;
    }
    code {
      background-color: #f8f8f8;
      padding: 2px 5px;
      border-radius: 3px;
      font-family: Monaco, Consolas, monospace;
      font-size: 0.9em;
    }
    .code-block {
      background-color: #f8f8f8;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
      font-family: Monaco, Consolas, monospace;
      font-size: 0.9em;
      margin: 15px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    tr:nth-child(even) {
      background-color: #f8f8f8;
    }
    .note {
      background-color: #e7f3fe;
      border-left: 4px solid #2196F3;
      padding: 15px;
      margin: 15px 0;
    }
    .warning {
      background-color: #fff8e1;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin: 15px 0;
    }
    .btn {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 20px;
      display: inline-block;
      text-decoration: none;
    }
    .btn:hover {
      background-color: #388E3C;
    }
    img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 15px auto;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    .language-selector {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 5px;
    }
    
    .language-selector a {
      padding: 3px 8px;
      border-radius: 3px;
      text-decoration: none;
      font-size: 12px;
      background-color: rgba(64, 196, 199, 0.1);
      color: #40c4c7;
    }
    
    .language-selector a:hover,
    .language-selector a.active {
      background-color: #40c4c7;
      color: white;
    }
    
    /* Estilos para la tabla de ejemplo de Excel */
    .excel-example {
      width: 100%;
      border-collapse: collapse;
      font-family: 'Calibri', Arial, sans-serif;
      font-size: 0.9em;
      margin: 20px 0;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      background-color: white;
      border: 1px solid #ccc;
    }
    
    .excel-example th {
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      padding: 6px 10px;
      text-align: center;
      font-weight: bold;
      color: #333;
    }
    
    .excel-example td {
      border: 1px solid #ccc;
      padding: 6px 10px;
      text-align: left;
      min-width: 20px;
    }
    
    .excel-example .empty-row td {
      height: 18px;
      padding: 2px 10px;
    }
    
    .excel-example tbody tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    /* Estilo para primera columna (nombres de filas) */
    .excel-example th:first-child,
    .excel-example td:first-child {
      width: 30px;
      background-color: #f0f0f0;
      font-weight: bold;
      text-align: center;
    }
  </style>
  
  <!-- Estilos comunes -->
  <style>
  /* Estilos para el selector de idiomas */
  .language-selector {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 5px;
  }
  
  .language-selector a {
    padding: 3px 8px;
    border-radius: 3px;
    text-decoration: none;
    font-size: 12px;
    background-color: rgba(64, 196, 199, 0.1);
    color: #40c4c7;
  }
  
  .language-selector a:hover,
  .language-selector a.active {
    background-color: #40c4c7;
    color: white;
  }
  
  /* Estilos de botones */
  .btn {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    margin-top: 20px;
    display: inline-block;
    text-decoration: none;
    transition: background-color 0.3s;
  }
  
  .btn:hover {
    background-color: #388E3C;
    text-decoration: none;
    color: white;
  }
  
  /* Botón para volver */
  .btn-back {
    background-color: #3498db;
  }
  
  .btn-back:hover {
    background-color: #2980b9;
  }
  </style>
  
</head>
<body>
  <div class="language-selector">
    <a href="#" id="es-link">ES</a>
    <a href="#" id="pt-link" class="active">PT-BR</a>
  </div>
  
  <div class="container">
    <h1>Ajuda do Conversor Excel para STL</h1>
    
    <!-- Enlace para volver a la aplicación principal -->
    <div style="margin-bottom: 20px;">
      <a href="#" id="back-link" class="btn" style="background-color: #3498db;">Voltar ao aplicativo</a>
    </div>
    
    <div class="section">
      <h2>Introdução</h2>
      <p>
        Esta aplicação converte arquivos Excel (XLSX ou XLS) com listas de legendas para o formato STL (EBU Subtitle Data Exchange Format),
        utilizado profissionalmente na indústria audiovisual para o intercâmbio de legendas.
      </p>
    </div>
    
    <div class="section">
      <h2>Formato do arquivo Excel de entrada</h2>
      <p>
        Para que a conversão funcione corretamente, seu arquivo Excel deve seguir este formato:
      </p>
      
      <table>
        <tr>
          <th>Conteúdo</th>
          <th>Localização</th>
          <th>Descrição</th>
        </tr>
        <tr>
          <td>Título em inglês</td>
          <td>Linha 3, Coluna C</td>
          <td>Título original do programa (opcional)</td>
        </tr>
        <tr>
          <td>Título em espanhol</td>
          <td>Linha 4, Coluna C</td>
          <td>Título traduzido do programa (opcional)</td>
        </tr>
        <tr>
          <td>Número do episódio</td>
          <td>Linha 5, Coluna C</td>
          <td>Número ou código do episódio (opcional)</td>
        </tr>
        <tr>
          <td>Timecode de entrada</td>
          <td>Coluna B, a partir da linha 11</td>
          <td>Formato: HH:MM:SS:FF (horas, minutos, segundos, frames)</td>
        </tr>
        <tr>
          <td>Texto da legenda</td>
          <td>Coluna C, a partir da linha 11</td>
          <td>O texto que será exibido na legenda</td>
        </tr>
        <tr>
          <td>Timecode de saída</td>
          <td>Coluna D, a partir da linha 11</td>
          <td>Formato: HH:MM:SS:FF (horas, minutos, segundos, frames)</td>
        </tr>
      </table>
      
      <div class="note">
        <strong>Nota:</strong> Os dados de legendas devem começar na linha 11. As linhas anteriores são utilizadas para metadados do programa.
      </div>
    </div>
    
    <div class="section">
      <h2>Exemplo de formato do Excel</h2>
      <p>
        A seguir, mostra-se um exemplo do formato esperado:
      </p>
      
      <table class="excel-example">
        <thead>
          <tr>
            <th>A</th>
            <th>B</th>
            <th>C</th>
            <th>D</th>
            <th>E</th>
          </tr>
        </thead>
        <tbody>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td style="text-align: center;"><strong>SUBTITLE LIST</strong></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td><strong>English Title:</strong> My Show</td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td><strong>Spanish Title:</strong> Mi Show</td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td><strong>Episode F100:</strong> One</td>
            <td></td>
            <td></td>
          </tr>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td><strong>Time code<br>in</strong></td>
            <td><strong>Spanish</strong></td>
            <td><strong>Time code<br>out</strong></td>
            <td><strong>English</strong></td>
          </tr>
          <tr>
            <td></td>
            <td>00:00:07:00</td>
            <td>Bienvenidos a la ciudad</td>
            <td>00:00:08:10</td>
            <td>Welcome to the city</td>
          </tr>
          <tr>
            <td></td>
            <td>00:00:08:19</td>
            <td>Hola</td>
            <td>00:00:10:02</td>
            <td>Hello</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="section">
      <h2>Formato do arquivo STL de saída</h2>
      <p>
        O formato STL gerado segue o padrão EBU STL (Tech. 3264-E), que inclui:
      </p>
      <ul>
        <li><strong>GSI (General Subtitle Information):</strong> Um cabeçalho de 1024 bytes com metadados do programa.</li>
        <li><strong>TTI (Text and Timing Information):</strong> Blocos de 128 bytes para cada legenda, que contêm o texto e os códigos de tempo.</li>
      </ul>
      
      <div class="warning">
        <strong>Importante:</strong> O formato STL utiliza um framerate de 25fps (padrão PAL) por padrão. O arquivo STL gerado pode requerer ajustes adicionais para sistemas NTSC (30fps) ou outros formatos de framerate.
      </div>
    </div>
    
    <div class="section">
      <h2>Passos para converter um arquivo</h2>
      <ol>
        <li>Prepare seu arquivo Excel seguindo o formato descrito acima.</li>
        <li>Na página principal, clique no botão "Selecionar arquivo" ou arraste e solte seu arquivo na área designada.</li>
        <li>Aguarde a conclusão do processo de conversão.</li>
        <li>Uma vez concluído, aparecerá um botão "Baixar arquivo STL". Clique nele para salvar o arquivo em seu dispositivo.</li>
      </ol>
    </div>
    
    <div class="section">
      <h2>Solução de problemas</h2>
      <h3>O arquivo não é convertido corretamente</h3>
      <ul>
        <li>Verifique se seu arquivo Excel segue exatamente o formato requerido.</li>
        <li>Certifique-se de que os timecodes têm o formato correto (HH:MM:SS:FF).</li>
        <li>Verifique se os dados de legendas começam na linha 11.</li>
        <li>Certifique-se de que o arquivo não exceda o limite de 5MB.</li>
      </ul>
      
      <h3>Caracteres especiais não são exibidos corretamente</h3>
      <p>
        O formato STL tem limitações com certos caracteres especiais. Se você experimenta problemas com caracteres acentuados ou símbolos, 
        considere simplificá-los em seu arquivo Excel antes da conversão.
      </p>
    </div>
    
    <div class="section">
      <h2>Contato e suporte</h2>
      <p>
        Se você precisar de ajuda adicional ou tiver dúvidas sobre a aplicação, contate <a href="mailto:appsheet@mediaaccesscompany.com">appsheet@mediaaccesscompany.com</a>.
      </p>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Usar la URL completa para redirigir a las páginas de ayuda o principal
      var scriptUrl = 'https://n-g4bcq6vfg2lukycdeyknkv2hgxjo47ccq7tetya-0lu-script.googleusercontent.com/userCodeAppPanel';
      
      // Configurar enlaces con URLs estáticas 
      var esLink = document.getElementById('es-link');
      var ptLink = document.getElementById('pt-link');
      var backLink = document.getElementById('back-link');
      
      if (esLink) {
        esLink.href = scriptUrl + '?page=help&lang=es';
      }
      
      if (ptLink) {
        ptLink.href = scriptUrl + '?page=help&lang=pt-BR';
      }
      
      if (backLink) {
        backLink.href = scriptUrl;
      }
      
      // Determinar el idioma actual
      var currentLang = 'pt-BR'; // Valor por defecto para la versión portuguesa
      try {
        var urlParams = new URLSearchParams(window.location.search);
        currentLang = urlParams.get('lang') || 'pt-BR';
      } catch (e) {
        console.error("Erro ao analisar parâmetros URL:", e);
      }
      
      // Marcar el enlace activo según el idioma actual
      if (esLink && ptLink) {
        if (currentLang === 'es') {
          esLink.classList.add('active');
          ptLink.classList.remove('active');
        } else if (currentLang === 'pt-BR') {
          ptLink.classList.add('active');
          esLink.classList.remove('active');
        }
      }
      
      console.log('Idioma atual: ' + currentLang);
      console.log('Links configurados:');
      console.log('- Espanhol: ' + (esLink ? esLink.href : 'não disponível'));
      console.log('- Português: ' + (ptLink ? ptLink.href : 'não disponível'));
      console.log('- Voltar: ' + (backLink ? backLink.href : 'não disponível'));
    });
  </script>
</body>
</html> 