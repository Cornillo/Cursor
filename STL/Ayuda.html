<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <link rel="icon" href="https://mediaaccesscompany.com/wp-content/uploads/2022/12/logo_banner_home.png" type="image/png">
  <title>Ayuda - Conversor Excel a STL</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2c3e50;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    h2 {
      color: #3498db;
      margin-top: 30px;
      padding-bottom: 5px;
      border-bottom: 1px solid #eee;
    }
    .section {
      margin-bottom: 30px;
    }
    code {
      background-color: #f8f8f8;
      padding: 2px 5px;
      border-radius: 3px;
      font-family: Monaco, Consolas, monospace;
      font-size: 0.9em;
    }
    .code-block {
      background-color: #f8f8f8;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
      font-family: Monaco, Consolas, monospace;
      font-size: 0.9em;
      margin: 15px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    tr:nth-child(even) {
      background-color: #f8f8f8;
    }
    .note {
      background-color: #e7f3fe;
      border-left: 4px solid #2196F3;
      padding: 15px;
      margin: 15px 0;
    }
    .warning {
      background-color: #fff8e1;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin: 15px 0;
    }
    .btn {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 20px;
      display: inline-block;
      text-decoration: none;
    }
    .btn:hover {
      background-color: #388E3C;
    }
    img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 15px auto;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    .language-selector {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 5px;
    }
    
    .language-selector a {
      padding: 3px 8px;
      border-radius: 3px;
      text-decoration: none;
      font-size: 12px;
      background-color: rgba(64, 196, 199, 0.1);
      color: #40c4c7;
    }
    
    .language-selector a:hover,
    .language-selector a.active {
      background-color: #40c4c7;
      color: white;
    }
    
    /* Estilos para la tabla de ejemplo de Excel */
    .excel-example {
      width: 100%;
      border-collapse: collapse;
      font-family: 'Calibri', Arial, sans-serif;
      font-size: 0.9em;
      margin: 20px 0;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      background-color: white;
      border: 1px solid #ccc;
    }
    
    .excel-example th {
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      padding: 6px 10px;
      text-align: center;
      font-weight: bold;
      color: #333;
    }
    
    .excel-example td {
      border: 1px solid #ccc;
      padding: 6px 10px;
      text-align: left;
      min-width: 20px;
    }
    
    .excel-example .empty-row td {
      height: 18px;
      padding: 2px 10px;
    }
    
    .excel-example tbody tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    /* Estilo para primera columna (nombres de filas) */
    .excel-example th:first-child,
    .excel-example td:first-child {
      width: 30px;
      background-color: #f0f0f0;
      font-weight: bold;
      text-align: center;
    }
  </style>
  
  <!-- Estilos comunes -->
  <style>
  /* Estilos para el selector de idiomas */
  .language-selector {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 5px;
  }
  
  .language-selector a {
    padding: 3px 8px;
    border-radius: 3px;
    text-decoration: none;
    font-size: 12px;
    background-color: rgba(64, 196, 199, 0.1);
    color: #40c4c7;
  }
  
  .language-selector a:hover,
  .language-selector a.active {
    background-color: #40c4c7;
    color: white;
  }
  
  /* Estilos de botones */
  .btn {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    margin-top: 20px;
    display: inline-block;
    text-decoration: none;
    transition: background-color 0.3s;
  }
  
  .btn:hover {
    background-color: #388E3C;
    text-decoration: none;
    color: white;
  }
  
  /* Botón para volver */
  .btn-back {
    background-color: #3498db;
  }
  
  .btn-back:hover {
    background-color: #2980b9;
  }
  </style>
  
</head>
<body>
  <div class="language-selector">
    <a href="#" id="es-link" class="active">ES</a>
    <a href="#" id="pt-link">PT-BR</a>
  </div>
  
  <div class="container">
    <h1>Ayuda del Conversor Excel a STL</h1>
    
    <div style="margin-bottom: 20px;">
      <a href="#" id="back-link" class="btn" style="background-color: #3498db;">Volver a la aplicación</a>
    </div>
    
    <div class="section">
      <h2>Introducción</h2>
      <p>
        Esta aplicación convierte archivos Excel (XLSX o XLS) con listas de subtítulos al formato STL (EBU Subtitle Data Exchange Format),
        utilizado profesionalmente en la industria audiovisual para el intercambio de subtítulos.
      </p>
    </div>
    
    <div class="section">
      <h2>Formato del archivo Excel de entrada</h2>
      <p>
        Para que la conversión funcione correctamente, su archivo Excel debe seguir este formato:
      </p>
      
      <table>
        <tr>
          <th>Contenido</th>
          <th>Ubicación</th>
          <th>Descripción</th>
        </tr>
        <tr>
          <td>Título en inglés</td>
          <td>Fila 3, Columna C</td>
          <td>Título original del programa (opcional)</td>
        </tr>
        <tr>
          <td>Título en español</td>
          <td>Fila 4, Columna C</td>
          <td>Título traducido del programa (opcional)</td>
        </tr>
        <tr>
          <td>Número de episodio</td>
          <td>Fila 5, Columna C</td>
          <td>Número o código del episodio (opcional)</td>
        </tr>
        <tr>
          <td>Timecode de entrada</td>
          <td>Columna B, desde fila 11</td>
          <td>Formato: HH:MM:SS:FF (horas, minutos, segundos, frames)</td>
        </tr>
        <tr>
          <td>Texto del subtítulo</td>
          <td>Columna C, desde fila 11</td>
          <td>El texto que se mostrará en el subtítulo</td>
        </tr>
        <tr>
          <td>Timecode de salida</td>
          <td>Columna D, desde fila 11</td>
          <td>Formato: HH:MM:SS:FF (horas, minutos, segundos, frames)</td>
        </tr>
      </table>
      
      <div class="note">
        <strong>Nota:</strong> Los datos de subtítulos deben comenzar en la fila 11. Las filas anteriores se utilizan para metadatos del programa.
      </div>
    </div>
    
    <div class="section">
      <h2>Ejemplo de formato de Excel</h2>
      <p>
        A continuación se muestra un ejemplo del formato esperado:
      </p>
      
      <table class="excel-example">
        <thead>
          <tr>
            <th>A</th>
            <th>B</th>
            <th>C</th>
            <th>D</th>
            <th>E</th>
          </tr>
        </thead>
        <tbody>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td style="text-align: center;"><strong>SUBTITLE LIST</strong></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td><strong>English Title:</strong> My Show</td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td><strong>Spanish Title:</strong> Mi Show</td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td><strong>Episode F100:</strong> One</td>
            <td></td>
            <td></td>
          </tr>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr class="empty-row">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td><strong>Time code<br>in</strong></td>
            <td><strong>Spanish</strong></td>
            <td><strong>Time code<br>out</strong></td>
            <td><strong>English</strong></td>
          </tr>
          <tr>
            <td></td>
            <td>00:00:07:00</td>
            <td>Bienvenidos a la ciudad</td>
            <td>00:00:08:10</td>
            <td>Welcome to the city</td>
          </tr>
          <tr>
            <td></td>
            <td>00:00:08:19</td>
            <td>Hola</td>
            <td>00:00:10:02</td>
            <td>Hello</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="section">
      <h2>Formato del archivo STL de salida</h2>
      <p>
        El formato STL generado sigue el estándar EBU STL (Tech. 3264-E), que incluye:
      </p>
      <ul>
        <li><strong>GSI (General Subtitle Information):</strong> Un encabezado de 1024 bytes con metadatos del programa.</li>
        <li><strong>TTI (Text and Timing Information):</strong> Bloques de 128 bytes por cada subtítulo, que contienen el texto y los códigos de tiempo.</li>
      </ul>
      
      <div class="warning">
        <strong>Importante:</strong> El formato STL utiliza un framerate de 25fps (estándar PAL) por defecto. El archivo STL generado puede requerir ajustes adicionales para sistemas NTSC (30fps) u otros formatos de framerate.
      </div>
    </div>
    
    <div class="section">
      <h2>Pasos para convertir un archivo</h2>
      <ol>
        <li>Prepare su archivo Excel siguiendo el formato descrito anteriormente.</li>
        <li>En la página principal, haga clic en el botón "Seleccionar archivo" o arrastre y suelte su archivo en el área designada.</li>
        <li>Espere a que se complete el proceso de conversión.</li>
        <li>Una vez completado, aparecerá un botón "Descargar archivo STL". Haga clic en él para guardar el archivo en su dispositivo.</li>
      </ol>
    </div>
    
    <div class="section">
      <h2>Solución de problemas</h2>
      <h3>El archivo no se convierte correctamente</h3>
      <ul>
        <li>Verifique que su archivo Excel siga exactamente el formato requerido.</li>
        <li>Asegúrese de que los timecodes tengan el formato correcto (HH:MM:SS:FF).</li>
        <li>Compruebe que los datos de subtítulos comiencen en la fila 11.</li>
        <li>Verifique que el archivo no exceda el límite de 5MB.</li>
      </ul>
      
      <h3>Caracteres especiales no se muestran correctamente</h3>
      <p>
        El formato STL tiene limitaciones con ciertos caracteres especiales. Si experimenta problemas con caracteres acentuados o símbolos, 
        considere simplificarlos en su archivo Excel antes de la conversión.
      </p>
    </div>
    
    <div class="section">
      <h2>Contacto y soporte</h2>
      <p>
        Si necesita ayuda adicional o tiene preguntas sobre la aplicación, contacte a <a href="mailto:appsheet@mediaaccesscompany.com">appsheet@mediaaccesscompany.com</a>.
      </p>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Usar la URL completa para redirigir a las páginas de ayuda o principal
      var scriptUrl = 'https://n-g4bcq6vfg2lukycdeyknkv2hgxjo47ccq7tetya-0lu-script.googleusercontent.com/userCodeAppPanel';
      
      // Configurar enlaces con URLs estáticas 
      var esLink = document.getElementById('es-link');
      var ptLink = document.getElementById('pt-link');
      var backLink = document.getElementById('back-link');
      
      if (esLink) {
        esLink.href = scriptUrl + '?page=help&lang=es';
      }
      
      if (ptLink) {
        ptLink.href = scriptUrl + '?page=help&lang=pt-BR';
      }
      
      if (backLink) {
        backLink.href = scriptUrl;
      }
      
      // Determinar el idioma actual
      var currentLang = 'es'; // Valor por defecto para la versión española
      try {
        var urlParams = new URLSearchParams(window.location.search);
        currentLang = urlParams.get('lang') || 'es';
      } catch (e) {
        console.error("Error al analizar parámetros URL:", e);
      }
      
      // Marcar el enlace activo según el idioma actual
      if (esLink && ptLink) {
        if (currentLang === 'es') {
          esLink.classList.add('active');
          ptLink.classList.remove('active');
        } else if (currentLang === 'pt-BR') {
          ptLink.classList.add('active');
          esLink.classList.remove('active');
        }
      }
      
      console.log('Idioma actual: ' + currentLang);
      console.log('Enlaces configurados:');
      console.log('- Español: ' + (esLink ? esLink.href : 'no disponible'));
      console.log('- Portugués: ' + (ptLink ? ptLink.href : 'no disponible'));
      console.log('- Volver: ' + (backLink ? backLink.href : 'no disponible'));
    });
  </script>
</body>
</html>